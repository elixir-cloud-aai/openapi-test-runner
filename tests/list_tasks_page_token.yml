name: List Tasks Page Token Job
description: Job to validate page token in list tasks
service: TES
versions:
  - 1.0.0
  - 1.1.0
tags:
  - logical
  - list tasks
  - get list tasks page token test
  - all
jobs:
  - name: create_task
    description: Create a new TES task
    endpoint: /tasks
    operation: POST
    request_body: |
      {
        "name": "CompTest",
        "description": "CompTest",
        "executors": [
          {
            "image": "alpine",
            "command": [
              "echo",
              "hello"
            ]
          }
        ]
      }
    response:
      200: {}
  - name: create_task
    description: Create a new TES task
    endpoint: /tasks
    operation: POST
    request_body: |
      {
        "name": "CompTest",
        "description": "CompTest",
        "executors": [
          {
            "image": "alpine",
            "command": [
              "echo",
              "hello"
            ]
          }
        ]
      }
    response:
      200: {}
  - name: list_tasks
    description: Store the next_page_token
    endpoint: /tasks
    operation: GET
    query_parameters:
      - view: MINIMAL
      - page_size: 1
    filter:
      - path: $response.tasks
        type: array
        size: 1
    storage_vars:
      next_page_token: $response.next_page_token
    response:
      200: {}
  - name: list_tasks
    description: Fetch response after sending stored next_page_token value
    endpoint: /tasks
    operation: GET
    query_parameters:
      - view: MINIMAL
      - page_size: 1
      - page_token: "{next_page_token}"
    filter:
      - path: $response.tasks
        type: array
        size: 1
    response:
      200: {}
